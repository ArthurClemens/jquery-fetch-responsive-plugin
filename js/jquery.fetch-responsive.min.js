/*
Fetch Responsive Image jQuery plugin
Version 0.1
(c) 2014 Arthur Clemens arthurclemens@gmail.com
https://github.com/ArthurClemens/jquery-fetch-responsive-plugin
*/
(function(e){var b,c,i=1,n="jquery-fetch-responsive",k={},t,h,o,u,j,s,v,g,x,a,y,f,m,p,r,q,l,d,w;t=function(E,C,D){var G,z;G=D[E];if(G!==undefined&&G!==""){if(C==="integer"){z=parseInt(G,10)}else{if(C==="float"){z=parseFloat(G,10)}else{if(C==="boolean"){z=(G===true||G==="true"||G===1||G==="1")?true:false}else{if(C==="range"){if(typeof G==="object"&&G.min!==undefined&&G.max!==undefined){z=G}else{var A=new RegExp(/(\d+)\s*[-, ]\s*(\d+)/).exec(G);z={min:parseInt(A[1],10),max:parseInt(A[2],10)}}}else{if(C==="array"){var F;if(Array.isArray(G)){F=G}else{F=G.split(/\s*,\s*/);if(F.length){for(var B=0;B<F.length;B++){F[B]=parseInt(F[B],10)}}}z=F.sort(function(I,H){return H-I})}}}}}if(z!==undefined){D[E]=z}}};h=function(z){t("widths","array",z);t("mediaQuery","boolean",z);t("range","range",z);t("stepSize","integer",z);t("ratio","float",z)};o=function(z){delete z.stepSize;delete z.range};u=function(z){delete z.urlSource;delete z.range;delete z.stepSize;delete z.widths;delete z.ratio;delete z.update;delete z.getWidth;delete z.mediaQuery};j=function(A){var z,C,G,F,E=[],D;z=A.stepSize;C=A.range.max-A.range.min;G=Math.ceil(C/z);F=C/G;for(var B=0;B<=G;B++){D=A.range.min+B*F;E.push(parseInt(D,10))}A.widths=E.reverse()};s=function(C,D){var B,A,z;B=e(C);A=e.extend({},e.fn.responsive.defaults,D,B.data());h(A);if(A.range){j(A)}o(A);z=e.extend({},A,B.data());u(z);B.attr("data-"+n,i);k[i++]={options:A,sendData:z,$el:B};v();a(B,A,z)};v=function(){if(c){return}e(window).on("resize",function(){if(b){clearTimeout(b)}b=setTimeout(function(){x()},e.responsive.resizeDelay)});c=true};g=function(){clearTimeout(b);e(window).off("resize");c=false};x=function(){var z;for(var A in k){z=k[A];a(z.$el,z.options,z.sendData)}};a=function(E,C,B){var D,A,G,z;D=Math.round(e(window).width());if(C.mediaQuery){A=w();if(C.getWidth){G=C.getWidth(E)}else{G=E.width()}}else{if(C.widths){G=p(C.widths,D);A=G.toString()}}if(f(E,A)){if(z===undefined&&C.ratio){z=G/C.ratio}var F=e.extend({},B);F.sizeId=A;F.width=G;F.height=z;y(E,C,F)}};p=function(B,A){var C=B[0];for(var z=1;z<B.length;z++){if(B[z]<A){break}C=B[z]}return C};f=function(A,z){if(A.data("size-id")!==z){return true}return false};y=function(C,B,z){var A;if(typeof(B.urlSource)==="function"){A=B.urlSource(z);q(C,A,B,z)}else{if(typeof(B.urlSource)==="string"){r(C,B.urlSource,B,z)}else{if(console){console.log("Invalid value for: url-source")}}}};r=function(C,z,B,A){e.ajax({url:z,type:"get",dataType:"json",data:{request:JSON.stringify(A)}}).done(function(E,F,D){if(E.error){if(console){console.log(E.error)}}else{q(C,E.url,B,A)}}).fail(function(D,F,E){if(console){console.log("Could not get url")}})};q=function(C,B,A,z){d(C,z.sizeId);if(A.update){A.update(C,e.extend({url:B},z))}else{l(C,B)}};l=function(A,z){if(A.is("img")){A.attr("src",z)}else{A.find("img").attr("src",z)}};d=function(A,z){A.data("size-id",z)};w=function(){var z;if(window.opera){z=window.getComputedStyle(document.body,":after").getPropertyValue("content")}else{if(window.getComputedStyle){z=window.getComputedStyle(document.head,null).getPropertyValue("font-family")}}return z};e.fn.responsive=function(z){return this.each(function(){s(this,z)})};e.responsive=function(z){e.extend(e.fn.responsive.defaults,z)};e.responsive.resizeDelay=500;e.fn.responsive.defaults={urlSource:undefined,range:undefined,stepSize:160,widths:undefined,ratio:undefined,update:undefined,getWidth:undefined,mediaQuery:undefined}}(jQuery));